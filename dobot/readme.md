# 스마트 팩토리: 인공지능를 활용한 자동 불량 검출 및 분류 시스템
## 1. 프로젝트 목표
본 프로젝트의 목표는 인공지능을 활용한 자동 불량 검출 및 분류 시스템을 구축하는 것입니다.
이를 위해 우리는 먼저 AI 모델을 개발할 것입니다. 이 AI 모델은 다양한 학습 데이터를 통해 훈련되며, 이를 통해 불량품과 정상품을 정확하게 구분할 수 있는 능력을 갖추게 됩니다.
다음으로, 우리는 카메라를 사용하여 실시간으로 제품 이미지를 캡처하고 AI 모델에 입력할 것입니다. 
마지막으로, AI 모델이 불량품을 감지하면, 우리는 로봇팔을 사용하여 불량품과 정상품을 신속하게 분류합니다. 
따라서, 이 프로젝트의 최종 목표는 AI 모델, 카메라, 그리고 로봇팔을 통합하여 높은 정확도와 효율성을 가진 자동 불량 검출 및 분류 시스템을 구축하는 것입니다

## 2. 개발 환경
### SW
* 운영 체제: Windows
* 개발 언어: Python 3.9
* 라이브러리:
  * pydobot: Dobot 로봇을 제어하기 위한 라이브러리
  * OpenCV (cv2): 이미지 처리를 위한 라이브러리
  * TensorFlow: 딥러닝 모델을 구축하고 학습하기 위한 라이브러리
  * Keras: TensorFlow의 고수준 API로, 딥러닝 모델을 빠르게 구축하고 학습할 수 있게 해주는 라이브러리
  * threading: 병렬 처리를 위한 라이브러리
* GPU 가속: CUDA 11.2

### HW
* Dobot Magician 2 개
* 카메라 intel Realsense D435: 1 개
* 컨베이어벨드 1 개
* 전체 시스템 구성도
  
![KakaoTalk_20240424_112222008](https://github.com/sika7492/inteledge/assets/154478957/080590cf-b3ee-497f-8bec-e2db36d004b8)


## 3. 동작 원리
본 시스템은 cv2 라이브러리를 활용하여 카메라로부터 입력을 받습니다. 이 입력은 이미지 데이터로, 이를 Keras 라이브러리를 사용하여 로드된 모델에 전달하여 불량 여부를 판정합니다.

불량 판정 결과에 따라 pydobot 라이브러리를 사용하여 Dobot 로봇을 제어합니다. 이때, Dobot의 동작은 threading을 활용하여 독립적으로 수행되도록 하였습니다. 이는 여러 동작을 동시에 수행할 수 있게 하여 시스템의 효율성을 높입니다.

또한, 각 쓰레드 간의 통신은 queue를 활용하여 수행하였습니다. 이를 통해 불량 판정과 분류 작업을 효율적으로 수행할 수 있습니다. 이러한 방식으로, 본 시스템은 실시간으로 불량품을 검출하고 분류하는 작업을 수행합니다.

## 4. AI 모델 학습
이번 프로젝트에서는 **티처블 머신(Teachable Machine)**을 사용하여 AI 모델을 학습시켰습니다. 티처블 머신은 사용자 친화적인 인터페이스를 제공하며, 기계 학습 모델을 빠르고 쉽게 만들 수 있습니다. 또한, 웹 기반 도구로서 별도의 설치 없이 브라우저에서 직접 사용할 수 있습니다. 이러한 이유로 인해, 티처블 머신은 인공지능 모델을 빠르고 효율적으로 학습시키는 데 있어 우수한 선택이 될 수 있습니다.

모델 학습 과정은 다음과 같습니다:

1. 학습 데이터 수집: 우리는 먼저 다양한 학습 데이터를 수집합니다. 이 데이터는 AI 모델이 불량품과 정상품을 정확하게 구분할 수 있는 능력을 갖추게 하는 데 사용됩니다.
2. 모델 학습: 수집된 데이터를 티처블 머신에 입력하여 AI 모델을 학습시킵니다. 이 과정에서 AI 모델은 학습 데이터의 패턴을 학습하고, 이를 바탕으로 불량품과 정상품을 구분하는 능력을 개발합니다.
3. 모델 검증: 학습된 모델의 성능을 검증합니다. 이를 위해 우리는 검증 데이터 세트를 사용하여 모델의 예측 성능을 평가합니다. 이 과정을 통해 모델의 정확도를 확인하고, 필요한 경우 모델을 더욱 향상시키기 위해 학습 과정을 반복합니다.
아래 사진은 모델 학습 과정을 보여줍니다:
* 티처블 머신 모델 학습 사진:
  ![화면 캡처 2024-04-24 103250](https://github.com/sika7492/inteledge/assets/154478957/30522145-c55d-49df-b349-17be238e1d5e)



  
## 5 .시연 영상
이번 프로젝트의 시연영상입니다. 
* 동영상 링크: (https://youtube.com/shorts/r_59fFBpwcY)


## 6. 결론
본 프로젝트를 통해 티처블 머신과 Dobot을 활용하여 불량 검출 및 분류 시스템을 성공적으로 구축하였습니다. 이 시스템은 스마트 팩토리에서 불량품 관리를 효율적으로 수행할 수 있게 해주며, 생산성 향상에 기여할 수 있습니다. 또한, 본 프로젝트는 머신 러닝과 로봇 기술을 결합하여 실제 문제를 해결하는 좋은 예시를 제공합니다.

